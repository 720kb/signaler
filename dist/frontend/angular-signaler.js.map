{"version":3,"file":"angular-signaler.js","sources":["../../lib/frontend/angular-signaler.js"],"sourcesContent":["/*global angular,Signaler*/\n(function withAngular(angular, Signaler) {\n  'use strict';\n\n  angular.module('720kb.signaler', [])\n  .provider('Signaler', function providerFunction() {\n\n    var signaler\n      , initSignaler = function initSignaler(urlOrComunicator, getUserMediaConst, sdpConst, debug) {\n\n        signaler = new Signaler(urlOrComunicator, getUserMediaConst, sdpConst, debug);\n      };\n\n    return {\n      'initSignaler': initSignaler,\n      '$get': ['$rootScope', '$window', '$log',\n      function instantiateProvider($rootScope, $window, $log) {\n\n        var onError = function onError(event) {\n\n          if (event &&\n            event.detail) {\n\n            $rootScope.$apply(function doApply(scope) {\n\n              $log.debug('signaler:error');\n              scope.$emit('signaler:error', event.detail);\n            });\n          }\n        }\n        , onGetUserMediaError = function onGetUserMediaError(event) {\n\n          if (event &&\n            event.detail) {\n\n            $rootScope.$apply(function doApply(scope) {\n\n              $log.debug('signaler:usermedia-error');\n              scope.$emit('signaler:usermedia-error', event.detail);\n            });\n          }\n        }\n        , onDataArrived = function onDataArrived(event) {\n\n          if (event &&\n            event.detail) {\n\n            $rootScope.$apply(function doApply(scope) {\n\n              $log.debug('signaler:data-arrived');\n              scope.$emit('signaler:data-arrived', event.detail);\n            });\n          } else {\n\n            $log.error('Missing mandatory event');\n          }\n        }\n        , onDataChannelOpened = function onDataChannelOpened(event) {\n\n          if (event &&\n            event.detail) {\n\n            $rootScope.$apply(function doApply(scope) {\n\n              $log.debug('signaler:datachannel-opened');\n              scope.$emit('signaler:datachannel-opened', event.detail);\n            });\n          } else {\n\n            $log.error('Missing mandatory event');\n          }\n        }\n        , onDataChannelClosed = function onDataChannelClosed(event) {\n\n          if (event &&\n            event.detail) {\n\n            $rootScope.$apply(function doApply(scope) {\n\n              $log.debug('signaler:datachannel-closed');\n              scope.$emit('signaler:datachannel-closed', event.detail);\n            });\n          } else {\n\n            $log.error('Missing mandatory event');\n          }\n        }\n        , onSignalerReady = function onSignalerReady(event) {\n\n          if (event &&\n            event.detail) {\n\n            $rootScope.$apply(function doApply(scope) {\n\n              $log.debug('signaler:ready');\n              scope.$emit('signaler:ready', event.detail);\n            });\n          } else {\n\n            $log.error('Missing mandatory event');\n          }\n        }\n        , onStreamArrive = function onStreamArrive(event) {\n\n          if (event &&\n            event.detail) {\n\n            $rootScope.$apply(function doApply(scope) {\n\n              scope.$emit('signaler:stream', event.detail);\n            });\n          } else {\n\n            $log.error('Missing mandatory event');\n          }\n        }\n        , onStreamEnd = function onStreamEnd(event) {\n\n          if (event &&\n            event.detail) {\n\n            $rootScope.$apply(function doApply(scope) {\n\n              scope.$emit('signaler:end', event.detail);\n            });\n          } else {\n\n            $log.error('Missing mandatory event');\n          }\n        }\n        , onMyStream = function onMyStream(event) {\n\n          if (event &&\n            event.detail) {\n\n            $rootScope.$apply(function doApply(scope) {\n\n              scope.$emit('signaler:my-stream', event.detail);\n            });\n          } else {\n\n            $log.error('Missing mandatory event');\n          }\n        };\n\n        $window.addEventListener('signaler:error', onError, false);\n        $window.addEventListener('signaler:usermedia-error', onGetUserMediaError, false);\n        $window.addEventListener('signaler:data-arrived', onDataArrived, false);\n        $window.addEventListener('signaler:datachannel-opened', onDataChannelOpened, false);\n        $window.addEventListener('signaler:datachannel-closed', onDataChannelClosed, false);\n        $window.addEventListener('signaler:ready', onSignalerReady, false);\n        $window.addEventListener('signaler:stream', onStreamArrive, false);\n        $window.addEventListener('signaler:end', onStreamEnd, false);\n        $window.addEventListener('signaler:my-stream', onMyStream, false);\n\n        $rootScope.$on('$destroy', function unregisterEventListener() {\n\n          $window.removeEventListener('signaler:error', onError, false);\n          $window.removeEventListener('signaler:usermedia-error', onGetUserMediaError, false);\n          $window.removeEventListener('signaler:data-arrived', onDataArrived, false);\n          $window.removeEventListener('signaler:datachannel-opened', onDataChannelOpened, false);\n          $window.removeEventListener('signaler:datachannel-closed', onDataChannelClosed, false);\n          $window.removeEventListener('signaler:ready', onSignalerReady, false);\n          $window.removeEventListener('signaler:stream', onStreamArrive, false);\n          $window.removeEventListener('signaler:end', onStreamEnd, false);\n          $window.removeEventListener('signaler:my-stream', onMyStream, false);\n        });\n\n        return signaler;\n      }]\n    };\n  });\n}(angular, Signaler));\n"],"names":[],"mappings":"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"}